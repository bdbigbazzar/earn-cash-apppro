<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Earn Cash Pro - Full Suite</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    
    <style>
        :root { --primary: #0088cc; --secondary: #28a745; --bg: #f4f7f6; --accent: #e91e63; --card-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        body { font-family: 'Segoe UI', Arial, sans-serif; background: var(--bg); margin: 0; padding-bottom: 80px; }
        .header { background: var(--primary); color: white; padding: 25px 20px; border-radius: 0 0 25px 25px; text-align: center; position: relative; }
        .card { background: white; padding: 20px; border-radius: 15px; margin: 15px; box-shadow: var(--card-shadow); }
        input, select { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        .task-btn { background: var(--primary); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; width: 100%; font-weight: bold; transition: 0.3s; margin-top: 5px; }
        
        /* UI Elements */
        #auth-container, #main-app, #vpn-blocker { display: none; }
        #video-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 9999; justify-content: center; align-items: center; flex-direction: column; }
        #player-container { width: 85%; max-width: 380px; aspect-ratio: 9/16; background: #000; border-radius: 15px; overflow: hidden; }
        .tips-card { background: #fff9c4; border-left: 5px solid #fbc02d; padding: 15px; border-radius: 8px; margin: 15px; font-size: 13px; }
    </style>
</head>
<body>

<div id="vpn-blocker" style="text-align:center; padding-top:100px;">
    <h1 style="color:red;">üö´ VPN Detected!</h1>
    <p>‡¶¶‡ßü‡¶æ ‡¶ï‡¶∞‡ßá ‡¶≠‡¶ø‡¶™‡¶ø‡¶è‡¶® ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡¶ü‡¶ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
    <button onclick="location.reload()" class="task-btn" style="width:200px;">‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
</div>

<div id="auth-container">
    <div class="header"><h2>Earn Cash Pro</h2><p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</p></div>
    <div class="card">
        <h3 id="auth-title">‡¶≤‡¶ó‡¶á‡¶®</h3>
        <input type="email" id="email" placeholder="‡¶á‡¶Æ‡ßá‡¶≤ ‡¶è‡¶°‡ßç‡¶∞‡ßá‡¶∏">
        <input type="password" id="password" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°">
        <button class="task-btn" onclick="handleAuth()" id="auth-btn">‡¶≤‡¶ó‡¶á‡¶®</button>
        <p style="text-align:center; font-size:13px; margin-top:15px; cursor:pointer; color:var(--primary);" onclick="toggleAuth()">‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡ßá‡¶á? ‡¶®‡¶§‡ßÅ‡¶® ‡¶ñ‡ßÅ‡¶≤‡ßÅ‡¶®</p>
    </div>
</div>

<div id="main-app">
    <div class="header">
        <h2 style="margin:0;">Earn Cash Pro</h2>
        <p id="user-display" style="font-size:12px; opacity:0.8;"></p>
        <button onclick="logout()" style="position:absolute; right:15px; top:15px; background:none; border:1px solid white; color:white; border-radius:15px; padding:2px 10px; font-size:10px;">‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü</button>
    </div>

    <div class="card" style="margin-top:-20px; text-align:center;">
        <h2 style="margin:0; color:var(--primary);">üí∞ <span id="user-coins">0</span></h2>
        <p style="margin:0; font-size:12px; color:#666;">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏</p>
    </div>

    <div class="tips-card">
        <b>üí° ‡¶™‡ßç‡¶∞‡ßã-‡¶ü‡¶ø‡¶™‡¶∏:</b> ‡ßØ:‡ßß‡ß¨ ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü‡ßá‡¶∞ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶∞‡¶ø‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¨‡ßá‡¶∂‡¶ø ‡¶¶‡ßá‡ßü‡•§ ‡ßß-‡ß© ‡¶Æ‡¶æ‡¶∏ ‡¶®‡¶ø‡ßü‡¶Æ‡¶ø‡¶§ ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßÅ‡¶®‡•§
    </div>

    <div class="card">
        <h3>üé¨ Watch & Earn</h3>
        <button class="task-btn" style="background:#ff0000;" onclick="openVideoTask('aiCjZQesNvo')">‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® (‡ßß‡ß¶ ‡¶ï‡ßü‡ßá‡¶®)</button>
    </div>

    <div class="card">
        <h3>üí∏ ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü</h3>
        <select id="w-method">
            <option value="Bkash">‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂ (Bkash)</option>
            <option value="Nagad">‡¶®‡¶ó‡¶¶ (Nagad)</option>
        </select>
        <input type="number" id="w-amount" placeholder="‡¶ï‡ßü‡ßá‡¶® ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ (‡¶Æ‡¶ø‡¶®‡¶ø‡¶Æ‡¶æ‡¶Æ ‡ß´‡ß¶‡ß¶‡ß¶)">
        <input type="text" id="w-number" placeholder="‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞">
        <button class="task-btn" style="background:var(--secondary);" onclick="submitWithdraw()">‡¶ü‡¶æ‡¶ï‡¶æ ‡¶§‡ßÅ‡¶≤‡ßÅ‡¶®</button>
    </div>

    <div class="card" id="admin-panel" style="display:none; border:2px dashed red;">
        <h3 style="color:red;">‚öôÔ∏è ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤</h3>
        <div id="withdraw-list" style="font-size:12px;"></div>
    </div>
    
    <p style="text-align:center;"><button onclick="openAdmin()" style="background:none; border:none; color:#ccc; font-size:10px;">Admin Login</button></p>
</div>

<div id="video-overlay">
    <div id="player-container"><div id="yt-player"></div></div>
    <p style="color:white; margin-top:10px;">‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶∂‡ßá‡¶∑ ‡¶π‡¶≤‡ßá ‡¶Ö‡¶ü‡ßã-‡¶ï‡ßç‡¶≤‡ßã‡¶ú ‡¶π‡¶¨‡ßá...</p>
</div>

<script>
    // --- ‡ßß. ‡¶´‡¶æ‡ßü‡¶æ‡¶∞‡¶¨‡ßá‡¶∏ ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶® ---
    const firebaseConfig = {
        apiKey: "AIzaSyDJRLhy3fnwDUvYDKSZK6UFo5DHskfn-A4",
        authDomain: "my-first-app-9f15d.firebaseapp.com",
        databaseURL: "https://my-first-app-9f15d-default-rtdb.firebaseio.com",
        projectId: "my-first-app-9f15d",
        storageBucket: "my-first-app-9f15d.firebasestorage.app",
        messagingSenderId: "869439564905",
        appId: "1:869439564905:web:ac84c328fbb1c73281d6f8"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();

    let currentUser = null;
    let balance = 0;
    let isLoginMode = true;

    // --- ‡ß®. ‡¶≠‡¶ø‡¶™‡¶ø‡¶è‡¶® ‡¶°‡¶ø‡¶ü‡ßá‡¶ï‡¶∂‡¶® ---
    async function checkVPN() {
        try {
            const res = await fetch('http://ip-api.com/json/?fields=proxy,hosting');
            const data = await res.json();
            if (data.proxy || data.hosting) {
                document.getElementById('vpn-blocker').style.display = 'block';
            } else {
                initAuth();
            }
        } catch (e) { initAuth(); }
    }
    checkVPN();

    // --- ‡ß©. ‡¶Ö‡¶•‡ßá‡¶®‡ßç‡¶ü‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶≤‡¶ú‡¶ø‡¶ï ---
    function initAuth() {
        auth.onAuthStateChanged(user => {
            if (user) {
                currentUser = user;
                document.getElementById('auth-container').style.display = 'none';
                document.getElementById('main-app').style.display = 'block';
                document.getElementById('user-display').innerText = user.email;
                loadData(user.uid);
            } else {
                document.getElementById('auth-container').style.display = 'block';
                document.getElementById('main-app').style.display = 'none';
            }
        });
    }

    function toggleAuth() {
        isLoginMode = !isLoginMode;
        document.getElementById('auth-title').innerText = isLoginMode ? "‡¶≤‡¶ó‡¶á‡¶®" : "‡¶®‡¶ø‡¶¨‡¶®‡ßç‡¶ß‡¶® (Sign Up)";
        document.getElementById('auth-btn').innerText = isLoginMode ? "‡¶≤‡¶ó‡¶á‡¶®" : "‡¶∏‡¶æ‡¶á‡¶®-‡¶Ü‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®";
    }

    function handleAuth() {
        const e = document.getElementById('email').value;
        const p = document.getElementById('password').value;
        if(isLoginMode) auth.signInWithEmailAndPassword(e, p).catch(err => alert(err.message));
        else auth.createUserWithEmailAndPassword(e, p).then(res => {
            db.ref('users/' + res.user.uid).set({ coins: 0, email: e });
        }).catch(err => alert(err.message));
    }

    function logout() { auth.signOut(); }

    // --- ‡ß™. ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ì ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ---
    function loadData(uid) {
        db.ref('users/' + uid).on('value', s => {
            balance = s.val() ? s.val().coins : 0;
            document.getElementById('user-coins').innerText = balance;
        });
    }

    function updateCoins(amount) {
        if(currentUser) db.ref('users/' + currentUser.uid).update({ coins: balance + amount });
    }

    // --- ‡ß´. ‡¶á‡¶â‡¶ü‡¶ø‡¶â‡¶¨ ‡¶è‡¶™‡¶ø‡¶Ü‡¶á ‡¶ì ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ---
    let player;
    let tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    document.head.appendChild(tag);

    function openVideoTask(vId) {
        document.getElementById('video-overlay').style.display = 'flex';
        if (player) player.loadVideoById(vId);
        else {
            player = new YT.Player('yt-player', {
                height: '100%', width: '100%', videoId: vId,
                playerVars: { 'autoplay': 0, 'controls': 1 },
                events: { 'onStateChange': e => {
                    if (e.data == YT.PlayerState.ENDED) {
                        updateCoins(10);
                        alert("‡ßß‡ß¶ ‡¶ï‡ßü‡ßá‡¶® ‡¶Ø‡ßã‡¶ó ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
                        document.getElementById('video-overlay').style.display = 'none';
                        player.stopVideo();
                    }
                }}
            });
        }
    }

    // --- ‡ß¨. ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ---
    function submitWithdraw() {
        const amt = parseInt(document.getElementById('w-amount').value);
        const num = document.getElementById('w-number').value;
        const method = document.getElementById('w-method').value;

        if (amt >= 5000 && balance >= amt && num.length >= 11) {
            db.ref('withdraws').push({
                uid: currentUser.uid, email: currentUser.email,
                amount: amt, number: num, method: method, time: Date.now()
            }).then(() => {
                updateCoins(-amt);
                alert("‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
            });
        } else alert("‡¶∏‡¶†‡¶ø‡¶ï ‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡¶® (‡¶Æ‡¶ø‡¶®‡¶ø‡¶Æ‡¶æ‡¶Æ ‡ß´‡ß¶‡ß¶‡ß¶ ‡¶ï‡ßü‡ßá‡¶®)");
    }

    // --- ‡ß≠. ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶≤‡¶ú‡¶ø‡¶ï ---
    function openAdmin() {
        if (prompt("Admin Password:") === "admin123") {
            document.getElementById('admin-panel').style.display = 'block';
            const list = document.getElementById('withdraw-list');
            db.ref('withdraws').on('value', s => {
                list.innerHTML = "";
                s.forEach(child => {
                    const d = child.val();
                    list.innerHTML += `<div style='border-bottom:1px solid #eee; padding:5px;'>
                        ${d.email} | ${d.method}: ${d.number} | <b>${d.amount} Coins</b>
                        <button onclick="db.ref('withdraws/${child.key}').remove()" style='color:red;'>Done/Delete</button>
                    </div>`;
                });
            });
        }
    }
</script>
</body>
</html>
