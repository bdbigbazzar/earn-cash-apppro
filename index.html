<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Earn Cash Pro - Fixed Version</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    
    <style>
        :root { --primary: #0088cc; --secondary: #28a745; --bg: #f4f7f6; --accent: #e91e63; --card-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        body { font-family: 'Segoe UI', Arial, sans-serif; background: var(--bg); margin: 0; padding-bottom: 80px; }
        .header { background: var(--primary); color: white; padding: 25px 20px; border-radius: 0 0 25px 25px; text-align: center; position: relative; }
        .card { background: white; padding: 20px; border-radius: 15px; margin: 15px; box-shadow: var(--card-shadow); }
        input, select { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        .task-btn { background: var(--primary); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; width: 100%; font-weight: bold; transition: 0.3s; margin-top: 5px; }
        #auth-container, #main-app { display: none; }
        #video-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 9999; justify-content: center; align-items: center; flex-direction: column; }
        #player-container { width: 85%; max-width: 380px; aspect-ratio: 9/16; background: #000; border-radius: 15px; overflow: hidden; }
    </style>
</head>
<body>

<div id="auth-container">
    <div class="header"><h2>Earn Cash Pro</h2><p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</p></div>
    <div class="card">
        <h3 id="auth-title">‡¶≤‡¶ó‡¶á‡¶®</h3>
        <input type="email" id="email" placeholder="‡¶á‡¶Æ‡ßá‡¶≤ ‡¶è‡¶°‡ßç‡¶∞‡ßá‡¶∏">
        <input type="password" id="password" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°">
        <button class="task-btn" onclick="handleAuth()" id="auth-btn">‡¶≤‡¶ó‡¶á‡¶®</button>
        <p style="text-align:center; font-size:13px; margin-top:15px; cursor:pointer; color:var(--primary);" onclick="toggleAuth()">‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡ßá‡¶á? ‡¶®‡¶§‡ßÅ‡¶® ‡¶ñ‡ßÅ‡¶≤‡ßÅ‡¶®</p>
    </div>
</div>

<div id="main-app">
    <div class="header">
        <h2 style="margin:0;">Earn Cash Pro</h2>
        <p id="user-display" style="font-size:11px; opacity:0.8;"></p>
        <button onclick="logout()" style="position:absolute; right:15px; top:15px; background:none; border:1px solid white; color:white; border-radius:15px; padding:2px 10px; font-size:10px;">‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü</button>
    </div>

    <div class="card" style="margin-top:-20px; text-align:center;">
        <h2 style="margin:0; color:var(--primary);">üí∞ <span id="user-coins">0</span></h2>
        <p style="margin:0; font-size:12px; color:#666;">‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏</p>
    </div>

    <div class="card">
        <h3>üé¨ Watch & Earn</h3>
        <button class="task-btn" style="background:#ff0000;" onclick="openVideoTask('aiCjZQesNvo')">‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® (‡ßß‡ß¶ ‡¶ï‡ßü‡ßá‡¶®)</button>
    </div>

    <div class="card">
        <h3>üí∏ ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü</h3>
        <input type="number" id="w-amount" placeholder="‡¶ï‡ßü‡ßá‡¶® ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ (‡ß´‡ß¶‡ß¶‡ß¶+)">
        <input type="text" id="w-number" placeholder="‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂/‡¶®‡¶ó‡¶¶ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞">
        <button class="task-btn" style="background:var(--secondary);" onclick="submitWithdraw()">‡¶ü‡¶æ‡¶ï‡¶æ ‡¶§‡ßÅ‡¶≤‡ßÅ‡¶®</button>
    </div>

    <p style="text-align:center;"><button onclick="openAdmin()" style="background:none; border:none; color:#ccc; font-size:10px;">Admin Login</button></p>
    <div id="admin-panel" class="card" style="display:none; border:2px dashed red;">
        <h3 style="color:red;">‚öôÔ∏è ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤</h3>
        <div id="withdraw-list" style="font-size:12px;"></div>
    </div>
</div>

<div id="video-overlay">
    <div id="player-container"><div id="yt-player"></div></div>
    <p style="color:white; margin-top:10px;">‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶∂‡ßá‡¶∑ ‡¶π‡¶≤‡ßá ‡¶Ö‡¶ü‡ßã-‡¶ï‡ßç‡¶≤‡ßã‡¶ú ‡¶π‡¶¨‡ßá...</p>
</div>

<script>
    // --- ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶´‡¶æ‡ßü‡¶æ‡¶∞‡¶¨‡ßá‡¶∏ ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶® ---
    const firebaseConfig = {
      apiKey: "AIzaSyDJRLhy3fnwDUvYDKBZX6UFp5DHskfn-A4",
      authDomain: "my-first-app-9f15d.firebaseapp.com",
      databaseURL: "https://my-first-app-9f15d-default-rtdb.firebaseio.com",
      projectId: "my-first-app-9f15d",
      storageBucket: "my-first-app-9f15d.firebasestorage.app",
      messagingSenderId: "669439564905",
      appId: "1:669439564905:web:ac04c320fbb1c73281d6f8",
      measurementId: "G-K33RV72MQE"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();

    let currentUser = null;
    let balance = 0;
    let isLoginMode = true;

    // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ü‡ßá‡¶ü ‡¶ö‡ßá‡¶ï
    auth.onAuthStateChanged(user => {
        if (user) {
            currentUser = user;
            document.getElementById('auth-container').style.display = 'none';
            document.getElementById('main-app').style.display = 'block';
            document.getElementById('user-display').innerText = user.email;
            loadData(user.uid);
        } else {
            document.getElementById('auth-container').style.display = 'block';
            document.getElementById('main-app').style.display = 'none';
        }
    });

    function toggleAuth() {
        isLoginMode = !isLoginMode;
        document.getElementById('auth-title').innerText = isLoginMode ? "‡¶≤‡¶ó‡¶á‡¶®" : "‡¶®‡¶ø‡¶¨‡¶®‡ßç‡¶ß‡¶® (Sign Up)";
        document.getElementById('auth-btn').innerText = isLoginMode ? "‡¶≤‡¶ó‡¶á‡¶®" : "‡¶∏‡¶æ‡¶á‡¶®-‡¶Ü‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®";
    }

    function handleAuth() {
        const e = document.getElementById('email').value;
        const p = document.getElementById('password').value;
        if (!e || !p) return alert("‡¶∏‡¶¨ ‡¶ò‡¶∞ ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®!");
        
        if(isLoginMode) {
            auth.signInWithEmailAndPassword(e, p).catch(err => alert("‡¶è‡¶∞‡¶∞: " + err.message));
        } else {
            auth.createUserWithEmailAndPassword(e, p).then(res => {
                db.ref('users/' + res.user.uid).set({ coins: 0, email: e });
            }).catch(err => alert("‡¶è‡¶∞‡¶∞: " + err.message));
        }
    }

    function logout() { auth.signOut(); }

    function loadData(uid) {
        db.ref('users/' + uid).on('value', s => {
            balance = s.val() ? s.val().coins : 0;
            document.getElementById('user-coins').innerText = balance;
        });
    }

    function updateCoins(amount) {
        if(currentUser) db.ref('users/' + currentUser.uid).update({ coins: balance + amount });
    }

    // --- ‡¶á‡¶â‡¶ü‡¶ø‡¶â‡¶¨ ‡¶è‡¶™‡¶ø‡¶Ü‡¶á ---
    let player;
    let tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    document.head.appendChild(tag);

    function openVideoTask(vId) {
        document.getElementById('video-overlay').style.display = 'flex';
        if (player) player.loadVideoById(vId);
        else {
            player = new YT.Player('yt-player', {
                height: '100%', width: '100%', videoId: vId,
                playerVars: { 'autoplay': 1, 'controls': 1 },
                events: { 'onStateChange': e => {
                    if (e.data == YT.PlayerState.ENDED) {
                        updateCoins(10);
                        alert("‡ßß‡ß¶ ‡¶ï‡ßü‡ßá‡¶® ‡¶Ø‡ßã‡¶ó ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
                        document.getElementById('video-overlay').style.display = 'none';
                        player.stopVideo();
                    }
                }}
            });
        }
    }

    function submitWithdraw() {
        const amt = parseInt(document.getElementById('w-amount').value);
        const num = document.getElementById('w-number').value;
        if (amt >= 5000 && balance >= amt && num.length >= 11) {
            db.ref('withdraws').push({
                uid: currentUser.uid, email: currentUser.email,
                amount: amt, number: num, time: Date.now()
            }).then(() => {
                updateCoins(-amt);
                alert("‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
            });
        } else alert("‡¶∏‡¶†‡¶ø‡¶ï ‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡¶® (‡¶Æ‡¶ø‡¶®‡¶ø‡¶Æ‡¶æ‡¶Æ ‡ß´‡ß¶‡ß¶‡ß¶ ‡¶ï‡ßü‡ßá‡¶®)");
    }

    function openAdmin() {
        if (prompt("‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°:") === "admin123") {
            document.getElementById('admin-panel').style.display = 'block';
            db.ref('withdraws').on('value', s => {
                const list = document.getElementById('withdraw-list');
                list.innerHTML = "";
                s.forEach(child => {
                    const d = child.val();
                    list.innerHTML += `<div style='border-bottom:1px solid #eee; padding:5px;'>
                        ${d.email} | No: ${d.number} | <b>${d.amount}</b>
                        <button onclick="db.ref('withdraws/${child.key}').remove()">Done</button>
                    </div>`;
                });
            });
        }
    }
</script>
</body>
</html>
