<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Earn Cash Pro - Ultimate Mini App</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        :root { --primary: #0088cc; --secondary: #28a745; --bg: #f4f7f6; --accent: #e91e63; --card-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        body { font-family: 'Segoe UI', Arial, sans-serif; background: var(--bg); margin: 0; padding-bottom: 80px; }
        .header { background: var(--primary); color: white; padding: 25px 20px; border-radius: 0 0 25px 25px; text-align: center; }
        .stat-card { background: white; margin: -25px 20px 20px; padding: 15px; border-radius: 15px; display: flex; justify-content: space-between; box-shadow: var(--card-shadow); font-weight: bold; }
        .card { background: white; padding: 20px; border-radius: 15px; margin: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .task-btn { background: var(--primary); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; width: 100%; font-weight: bold; margin-top: 10px; transition: 0.3s; }
        .task-btn:active { transform: scale(0.98); }
        .nav-bar { position: fixed; bottom: 0; width: 100%; background: white; display: flex; justify-content: space-around; padding: 10px 0; border-top: 1px solid #ddd; z-index: 1000; }
        .nav-item { border: none; background: none; color: #666; font-size: 11px; cursor: pointer; text-align: center; }
        .active-nav { color: var(--primary); font-weight: bold; }
        #user-notification { background: #fff3cd; color: #856404; margin: 10px 20px; padding: 10px; border-radius: 8px; border-left: 5px solid #ffeeba; display: none; }
        input, select, textarea { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        .ad-box { background: #fffde7; border: 1px dashed #ffd54f; padding: 10px; margin: 10px 0; font-size: 11px; text-align: center; color: #888; }
        
        /* New Styles for Leaderboard & Referral */
        .leader-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .leader-table th, .leader-table td { padding: 12px; text-align: left; border-bottom: 1px solid #eee; }
        .refer-box { background: #e3f2fd; padding: 15px; border-radius: 12px; text-align: center; border: 2px dashed #2196f3; margin-top: 10px; }
    </style>
</head>
<body>

<div class="header">
    <h2 style="margin:0;">Earn Cash Pro</h2>
    <p style="margin:5px 0 0; font-size:12px; opacity:0.9;">рж╕рж╣ржЬ ржХрж╛ржЬ ржХрж░рзБржи, ржкрзЗржорзЗржирзНржЯ ржирж┐ржи ржжрзНрж░рзБржд!</p>
</div>

<div class="stat-card">
    <span>ЁЯТ░ ржмрзНржпрж╛рж▓рзЗржирзНрж╕: <span id="user-coins">0</span></span>
    <span>ЁЯЖФ ID: <span id="user-id-display">...</span></span>
</div>

<div id="user-notification">
    <b>ЁЯФФ ржирзЛржЯрж┐рж╢:</b> <span id="notice-text"></span>
</div>

<div id="main-content">
    <div id="home-page" class="page">
        <div class="card">
            <h3>ЁЯОе ржнрж┐ржбрж┐ржУ ржЯрж╛рж╕рзНржХ (рззрзл рж╕рзЗ.)</h3>
            <div class="ad-box">ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрзБржи ржПржмржВ ржХрзЯрзЗржи ржЖрзЯ ржХрж░рзБржи</div>
            <button class="task-btn" id="v-btn" onclick="startVideoTask()">ржЕрзНржпрж╛ржб ржжрзЗржЦрзЗ рззрзж ржХрзЯрзЗржи ржирж┐ржи</button>
            <p id="v-timer" style="text-align:center; color:red; font-weight:bold;"></p>
        </div>
        
        <div class="card">
            <h3>ЁЯСл рж░рзЗржлрж╛рж░рж╛рж▓ ржмрзЛржирж╛рж╕</h3>
            <div class="refer-box">
                <p style="margin:0; font-size:12px; color:#555;">ржЖржкржирж╛рж░ рж░рзЗржлрж╛рж░ ржХрзЛржб:</p>
                <h3 id="ref-code-text" style="margin:5px 0; color:var(--primary);">...</h3>
                <button class="task-btn" style="background:#673ab7; font-size: 13px;" onclick="shareReferral()">ржмржирзНржзрзБржжрзЗрж░ рж╕рж╛ржерзЗ рж╢рзЗрзЯрж╛рж░ ржХрж░рзБржи</button>
            </div>
        </div>

        <div class="card">
            <h3>ЁЯФЧ рж╕рзЛрж╢рзНржпрж╛рж▓ ржорж┐ржбрж┐рзЯрж╛ ржЯрж╛рж╕рзНржХ</h3>
            <button class="task-btn" style="background:#ff0000" onclick="handleSocial('https://www.youtube.com/@sobujsalmanofficial')">YouTube Subscribe</button>
            <button class="task-btn" style="background:#1877f2" onclick="handleSocial('https://www.facebook.com/bdbigbazzarofficial')">Facebook Follow</button>
        </div>
    </div>

    <div id="games-page" class="page" style="display:none;">
        <div class="card" style="background: linear-gradient(135deg, #6e8efb, #a777e3); color: white; text-align:center;">
            <h3>ЁЯОБ ржбрзЗржЗрж▓рж┐ ржмрзЛржирж╛рж╕</h3>
            <button class="task-btn" style="background:white; color:#6e8efb" onclick="claimDaily()">ржмрзЛржирж╛рж╕ ржХрзНрж▓рзЗржЗржо ржХрж░рзБржи</button>
        </div>
        <div class="card" style="text-align:center;">
            <h3>ЁЯОб рж▓рж╛ржХрж┐ рж╕рзНржкрж┐ржи</h3>
            <div id="wheel" style="font-size:50px; margin: 10px 0;">ЁЯОб</div>
            <button class="task-btn" id="spin-btn" onclick="startSpin()">рж╕рзНржкрж┐ржи ржХрж░рзЗ ржЬрж┐рждрзБржи</button>
        </div>
    </div>

    <div id="leaderboard-page" class="page" style="display:none;">
        <div class="card">
            <h3 style="text-align:center;">ЁЯПЖ рж╕рзЗрж░рж╛ рззрзж ржЕрж░рзНржЬржиржХрж╛рж░рзА</h3>
            <table class="leader-table">
                <thead>
                    <tr><th>Rank</th><th>User ID</th><th>Coins</th></tr>
                </thead>
                <tbody id="leader-body">
                    <tr><td colspan="3" style="text-align:center;">рж▓рзЛржб рж╣ржЪрзНржЫрзЗ...</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <div id="withdraw-page" class="page" style="display:none;">
        <div class="card">
            <h3>ЁЯТ╕ ржкрзЗржорзЗржирзНржЯ ржирж┐ржи</h3>
            <select id="method">
                <option value="Bkash">Bkash</option>
                <option value="Nagad">Nagad</option>
                <option value="Recharge">Mobile Recharge</option>
            </select>
            <input type="number" id="w-amount" placeholder="ржХрзЯрзЗржи (ржорж┐ржирж┐ржорж╛ржо рзлрзжрзжрзж)">
            <input type="text" id="w-number" placeholder="ржЖржкржирж╛рж░ ржиржорзНржмрж░">
            <button class="task-btn" style="background:var(--accent)" onclick="submitWithdraw()">рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржкрж╛ржарж╛ржи</button>
        </div>
    </div>

    <div id="support-page" class="page" style="display:none;">
        <div class="card" style="text-align:center;">
            <h3>ЁЯОз рж╣рзЗрж▓рзНржк рж╕рзЗржирзНржЯрж╛рж░</h3>
            <button class="task-btn" onclick="window.open('https://t.me/aibdkingbot')">Admin (Telegram)</button>
            <button class="task-btn" style="background:var(--secondary)" onclick="window.open('https://t.me/aibdking')">Official Channel</button>
        </div>
        <div class="card" style="font-size: 13px; line-height: 1.6; color: #444; border-top: 4px solid var(--accent);">
            <h4 style="text-align: center; color: var(--accent);">тЪая╕П ржирж┐рзЯржорж╛ржмрж▓рзА</h4>
            <ol>
                <li>VPN ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╕ржорзНржкрзВрж░рзНржг ржирж┐рж╖рж┐ржжрзНржзред</li>
                <li>ржПржХ ржбрж┐ржнрж╛ржЗрж╕рзЗ ржПржХрж╛ржзрж┐ржХ ржПржХрж╛ржЙржирзНржЯ ржХрж░рж╛ ржпрж╛ржмрзЗ ржирж╛ред</li>
                <li>ржЖржиржлрж▓рзЛ ржХрж░рж▓рзЗ ржХрзЯрзЗржи ржХрзЗржЯрзЗ ржирзЗржУрзЯрж╛ рж╣ржмрзЗред</li>
            </ol>
        </div>
    </div>

    <div id="admin-page" class="page" style="display:none;">
        <div class="card" style="border:2px solid red;">
            <h3>ЁЯУв ржЕрзНржпрж╛ржбржорж┐ржи ржкрзНржпрж╛ржирзЗрж▓</h3>
            <textarea id="admin-msg" rows="3" placeholder="ржирждрзБржи ржирзЛржЯрж┐рж╢ рж▓рж┐ржЦрзБржи..."></textarea>
            <button class="task-btn" onclick="sendBroadcast()">ржирзЛржЯрж┐рж╢ ржЖржкржбрзЗржЯ ржХрж░рзБржи</button>
        </div>
    </div>
</div>

<div class="nav-bar">
    <button class="nav-item active-nav" onclick="showTab('home', this)">ЁЯПа<br>рж╣рзЛржо</button>
    <button class="nav-item" onclick="showTab('games', this)">ЁЯОо<br>ржЧрзЗржорж╕</button>
    <button class="nav-item" onclick="showTab('leaderboard', this); loadLeaderboard()">ЁЯПЖ<br>рж╕рзЗрж░рж╛ рззрзж</button>
    <button class="nav-item" onclick="showTab('withdraw', this)">ЁЯТ░<br>ржЙржЗржержбрзНрж░</button>
    <button class="nav-item" onclick="showTab('admin', this)">тЪЩя╕П<br>рж╕рзЗржЯрж┐ржВрж╕</button>
</div>

<script>
    // --- FIREBASE CONFIG ---
    const firebaseConfig = {
        apiKey: "AIzaSyDJRLhy3fnwDUvYDKSZK6UFo5DHskfn-A4",
        authDomain: "my-first-app-9f15d.firebaseapp.com",
        databaseURL: "https://my-first-app-9f15d-default-rtdb.firebaseio.com",
        projectId: "my-first-app-9f15d",
        storageBucket: "my-first-app-9f15d.firebasestorage.app",
        messagingSenderId: "869439564905",
        appId: "1:869439564905:web:ac84c328fbb1c73281d6f8",
        measurementId: "G-K33RV72MQE"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let userId = localStorage.getItem('bt_uid') || "user_" + Math.floor(1000 + Math.random() * 9000);
    localStorage.setItem('bt_uid', userId);
    document.getElementById('user-id-display').innerText = userId;
    document.getElementById('ref-code-text').innerText = userId;
    let balance = 0;

    // ржмрзНржпрж╛рж▓рзЗржирзНрж╕ рж╕рж┐ржЩрзНржХ
    db.ref('users/' + userId).on('value', (s) => {
        let data = s.val();
        balance = data ? data.coins : 0;
        document.getElementById('user-coins').innerText = balance;
        if(!data) db.ref('users/' + userId).set({ coins: 0, userId: userId });
    });

    // ржирзЛржЯрж┐рж╢ рж▓рж┐рж╕рзЗржирж╛рж░
    db.ref('broadcast/').on('value', (s) => {
        if(s.val()) {
            document.getElementById('user-notification').style.display = 'block';
            document.getElementById('notice-text').innerText = s.val().message;
        }
    });

    // --- ржЯрж╛рж╕рзНржХ ржлрж╛ржВрж╢ржирж╕ржорзВрж╣ ---

    function startVideoTask() {
        let btn = document.getElementById('v-btn');
        let timerDisplay = document.getElementById('v-timer');
        let count = 15;
        btn.disabled = true;
        window.open('https://omg10.com/4/10587051', '_blank');
        
        let t = setInterval(() => {
            timerDisplay.innerText = "ржЕржкрзЗржХрзНрж╖рж╛ ржХрж░рзБржи: " + count-- + "s";
            if(count < 0) { 
                clearInterval(t); 
                updateCoins(10); 
                btn.disabled = false; 
                timerDisplay.innerText = ""; 
                alert("рж╕рж╛ржлрж▓рзНржпрзЗрж░ рж╕рж╛ржерзЗ рззрзж ржХрзЯрзЗржи ржпрзЛржЧ рж╣рзЯрзЗржЫрзЗ!"); 
            }
        }, 1000);
    }

    function handleSocial(url) {
        window.open(url, '_blank');
        setTimeout(() => {
            updateCoins(20);
            alert("ржЯрж╛рж╕рзНржХ ржнрзЗрж░рж┐ржлрж╛ржЗ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ! рзирзж ржХрзЯрзЗржи ржмрзЛржирж╛рж╕ ржкрзЗрзЯрзЗржЫрзЗржиред");
        }, 8000);
    }

    function claimDaily() {
        const last = localStorage.getItem('last_d');
        const now = Date.now();
        if(last && now - last < 86400000) return alert("рзирзк ржШржгрзНржЯрж╛ ржкрж░ ржЖржмрж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржи!");
        updateCoins(50); 
        localStorage.setItem('last_d', now); 
        alert("рзлрзж ржХрзЯрзЗржи ржбрзЗржЗрж▓рж┐ ржмрзЛржирж╛рж╕ ржкрзЗрзЯрзЗржЫрзЗржи!");
    }

    function startSpin() {
        let win = Math.floor(Math.random() * 20);
        updateCoins(win); 
        alert("ржЖржкржирж┐ ржЬрж┐рждрзЗржЫрзЗржи " + win + " ржХрзЯрзЗржи!");
    }

    function updateCoins(a) { 
        db.ref('users/' + userId).update({ coins: balance + a }); 
    }

    // рж▓рж┐ржбрж╛рж░ржмрзЛрж░рзНржб рж▓рзЛржб ржХрж░рж╛
    function loadLeaderboard() {
        const body = document.getElementById('leader-body');
        db.ref('users').orderByChild('coins').limitToLast(10).once('value', (snapshot) => {
            body.innerHTML = "";
            let data = [];
            snapshot.forEach(item => { data.push(item.val()); });
            data.reverse().forEach((u, i) => {
                body.innerHTML += `<tr><td>${i+1}</td><td>${u.userId}</td><td>${u.coins}</td></tr>`;
            });
        });
    }

    function shareReferral() {
        const msg = `Earn Cash Pro ржЕрзНржпрж╛ржкрзЗ ржЖржорж╛рж░ рж░рзЗржлрж╛рж░ ржХрзЛржб ${userId} ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЯрж╛ржХрж╛ ржЖрзЯ ржХрж░рзБржи!`;
        window.open(`https://wa.me/?text=${encodeURIComponent(msg)}`);
    }

    function submitWithdraw() {
        let a = parseInt(document.getElementById('w-amount').value);
        let n = document.getElementById('w-number').value;
        if(a >= 5000 && balance >= a && n.length > 10) {
            db.ref('withdraws').push({ userId, amount: a, number: n, status: 'Pending', time: Date.now() });
            updateCoins(-a); 
            alert("ржкрзЗржорзЗржирзНржЯ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржкрж╛ржарж╛ржирзЛ рж╣рзЯрзЗржЫрзЗ! рзирзк ржШржгрзНржЯрж╛рж░ ржоржзрзНржпрзЗ ржкрзЗржорзЗржирзНржЯ ржкрж╛ржмрзЗржиред");
        } else alert("рж╕ржарж┐ржХ рждржерзНржп ржжрж┐ржи ржЕржержмрж╛ ржкрж░рзНржпрж╛ржкрзНржд ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржирзЗржЗ (ржорж┐ржирж┐ржорж╛ржо рзлрзжрзжрзж)!");
    }

    function sendBroadcast() {
        let msg = document.getElementById('admin-msg').value;
        if(msg) {
            db.ref('broadcast/').set({ message: msg });
            alert("рж╕ржлрж▓ржнрж╛ржмрзЗ ржирзЛржЯрж┐рж╢ ржЖржкржбрзЗржЯ рж╣рзЯрзЗржЫрзЗ!");
        }
    }

    function showTab(t, b) {
        if (t === 'admin') {
            let password = prompt("ржЕрзНржпрж╛ржбржорж┐ржи ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб ржжрж┐ржи:");
            if (password !== "IloveAllahIloveMuhammad807952$") {
                alert("ржнрзБрж▓ ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб!"); return;
            }
        }
        document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
        document.getElementById(t + '-page').style.display = 'block';
        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active-nav'));
        b.classList.add('active-nav');
    }
</script>
</body>
</html>

